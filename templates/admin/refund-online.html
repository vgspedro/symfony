
{% extends "admin/p-base.html.twig" %}

{% block content %}

<div class="w3-container">

<div class="w3-xxlarge w3-row w3-xlarge w3-padding w3-margin-top">
  <i class="fa fa-reply"></i> {{translator.refund}}
</div>

  <form id="refund-form">
  <input type="hidden" name='id' value="{{booking.id}}">
  <div class="w3-row-padding w3-card-2 w3-sand w3-padding w3-large" style="max-width:600px;margin: 0 auto">
     <div class="w3-col l12 w3-xlarge">
      <label>{{translator.purchase_data}} #{{booking.id}}</label>
    </div>

    <div class="w3-col s12">
      <label>{{translator.tour}}:</label>
          <span class="">
        {% if booking.client.locale.name == 'pt_PT' %}
          {{booking.available.category.namePt}}
        {% else %}
          {{booking.available.category.nameEn}}
        {% endif %}
      </span>
    </div>
    <div class="w3-col s12">
      <label>{{translator.status}}:</label>
      <span class="{{booking.status}}" style="text-transform: uppercase">{{translator.booking_status}}</span>
    </div>
    <div class="w3-col s12">
      <label>{{translator.payment}}:</label>
      <span class="{{booking.paymentStatus}}" style="text-transform: uppercase">{{translator.payment_status}}</span>
    </div>

    <div class="w3-col s12">
      <label>{{translator.date}}:</label>
      <span class="">{{booking.available.datetimestart|date('d/m/Y @ H:i')}}</span>
    </div>
    <div class="w3-col s12">
      <label>{{translator.name}}:</label>
      <span class="u-name">{{booking.client.username}}</span>
    </div>
    
    <div class="w3-col s12">
      <label>Email:</label>
      <span class="u-email">{{booking.client.email}}</span>
    </div>
    <div class="w3-col s12">
      <label>{{translator.adults}}:</label>
      <span class="">{{booking.adult}}</span>
    </div>

    <div class="w3-col s12">
      <label>{{translator.childrens}}:</label>
      <span class="">{{booking.children}}</span>
    </div>

    <div class="w3-col s12 w3-margin-bottom w3-border-bottom">
      <label>{{translator.babies}}:</label>
      <span class="">{{booking.baby}}</span>
    </div>

    <div class="w3-col l6 m6 s12">
      <label>{{translator.amount}}</label>
      <input type="hidden" value="{{booking.id}}" name="b_id">
      <input class="w3-input w3-border" name='amount' style="height:45px" value="{{(booking.amount.amount/100)|number_format(2)}}">
    </div>
    <div class="w3-col l6 m6 s12">
      <label>{{translator.motive}}</label>
      <select name='reason' class="w3-select w3-border" style="height:45px">
      {% for reason in reasons %}
        <option value="{{reason.value}}">{{reason.text}}</option>
      {% endfor %}
      <select>
    </div>
    <div class="w3-col s12 w3-margin-top">
      <span class="w3-button w3-orange w3-border w3-right w3-margin-bottom w3-block" onclick="paymentRefund()">
      <i class="fa fa-reply"></i> {{translator.refund}}
      </span>
    </div>

  </div>
  </form>
</div>

<script>

//make refund
function paymentRefund(){
  $('.w3-overlay').show()
  setTimeout(function(){
    $.ajax({ Â 
      url :'{{ path('online_payment_refund')}}',
      type: "POST",
      data:$('#refund-form').serialize(),
      cache: false,
      success: function(data){
        $('.w3-overlay').hide()
        console.log(data)
        if (data.status == 1)
          modalConditions(0, data.message, '{{translator.success}}')
        else
          modalConditions(1, data.message, '{{translator.check}}') 
      },
      error:function(){
        $('.w3-overlay').hide()
        modalConditions(2, '{{translator.wifi_error}}', '{{translator.error}}')
      }
    })
  }, 500)
}

</script>

{% endblock %}